<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì •ë¶€ì§€ì›ê¸ˆ ê³„ì‚°ê¸° - StaffManager</title>
<style>
  :root {
    --blue: #2156D0; --blue-light: #EEF2FF;
    --green: #16A34A; --green-light: #F0FDF4;
    --red: #DC2626; --red-light: #FEF2F2;
    --orange: #EA580C; --orange-light: #FFF7ED;
    --gray: #6B7280; --border: #E5E7EB;
    --dark: #111827;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { font-family: 'Pretendard', -apple-system, sans-serif; background: #F9FAFB; color: var(--dark); }

  /* ê³µí†µ navbar */
  .navbar { background: white; border-bottom: 1px solid var(--border); padding: 0 24px; height: 56px; display: flex; align-items: center; justify-content: space-between; position: sticky; top: 0; z-index: 100; }
  .navbar-brand { font-size: 18px; font-weight: 700; color: var(--blue); text-decoration: none; }
  .navbar-back { font-size: 14px; color: var(--gray); text-decoration: none; display: flex; align-items: center; gap: 4px; }
  .navbar-back:hover { color: var(--blue); }

  .container { max-width: 1000px; margin: 0 auto; padding: 32px 24px; }
  h1 { font-size: 22px; font-weight: 700; margin-bottom: 4px; }
  .subtitle { color: var(--gray); font-size: 14px; margin-bottom: 28px; }

  /* ìš”ì•½ ì¹´ë“œ */
  .summary-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 14px; margin-bottom: 28px; }
  .summary-card { background: white; border-radius: 12px; border: 1px solid var(--border); padding: 18px; }
  .summary-card .label { font-size: 12px; color: var(--gray); margin-bottom: 6px; }
  .summary-card .value { font-size: 22px; font-weight: 700; }
  .summary-card.green .value { color: var(--green); }
  .summary-card.blue .value { color: var(--blue); }
  .summary-card.orange .value { color: var(--orange); }

  /* ë‘ë£¨ëˆ„ë¦¬ ì¡°ê±´ ë°•ìŠ¤ */
  .condition-box { background: var(--blue-light); border: 1px solid #C7D7FA; border-radius: 12px; padding: 18px 20px; margin-bottom: 28px; }
  .condition-box h3 { font-size: 14px; font-weight: 600; color: var(--blue); margin-bottom: 10px; }
  .condition-list { display: flex; gap: 20px; flex-wrap: wrap; }
  .condition-item { font-size: 13px; color: var(--dark); display: flex; align-items: center; gap: 6px; }
  .condition-item::before { content: 'âœ“'; color: var(--green); font-weight: 700; }

  /* ì‚¬ì—…ì¥ ì¸ì› ê²½ê³  */
  .warning-box { background: var(--orange-light); border: 1px solid #FED7AA; border-radius: 10px; padding: 14px 16px; margin-bottom: 24px; font-size: 13px; color: #9A3412; display: none; }
  .warning-box.show { display: flex; gap: 8px; align-items: flex-start; }

  /* í…Œì´ë¸” */
  .table-wrap { background: white; border-radius: 12px; border: 1px solid var(--border); overflow: hidden; margin-bottom: 24px; }
  .table-header { padding: 16px 20px; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
  .table-header h2 { font-size: 15px; font-weight: 600; }
  .badge { font-size: 11px; font-weight: 600; padding: 3px 8px; border-radius: 20px; }
  .badge-green { background: var(--green-light); color: var(--green); }
  .badge-red { background: var(--red-light); color: var(--red); }
  .badge-gray { background: #F3F4F6; color: var(--gray); }
  table { width: 100%; border-collapse: collapse; }
  th { background: #F9FAFB; font-size: 12px; font-weight: 600; color: var(--gray); padding: 10px 16px; text-align: left; border-bottom: 1px solid var(--border); }
  td { padding: 13px 16px; font-size: 13px; border-bottom: 1px solid var(--border); }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: #FAFAFA; }
  .amount { font-weight: 600; font-family: 'Courier New', monospace; }
  .amount.green { color: var(--green); }
  .amount.gray { color: var(--gray); }

  /* ì§€ì›ê¸ˆ ìƒì„¸ íˆ´íŒ ìŠ¤íƒ€ì¼ ì…€ */
  .detail-cell { font-size: 11px; color: var(--gray); margin-top: 2px; }

  /* ì‹ ì²­ ì•ˆë‚´ ì¹´ë“œ */
  .guide-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; margin-bottom: 24px; }
  .guide-card { background: white; border-radius: 12px; border: 1px solid var(--border); padding: 20px; }
  .guide-card h3 { font-size: 14px; font-weight: 600; margin-bottom: 10px; display: flex; align-items: center; gap: 6px; }
  .guide-card p, .guide-card li { font-size: 13px; color: var(--gray); line-height: 1.7; }
  .guide-card ul { padding-left: 16px; }
  .btn-link { display: inline-flex; align-items: center; gap-4px; background: var(--blue); color: white; text-decoration: none; padding: 8px 16px; border-radius: 8px; font-size: 13px; font-weight: 600; margin-top: 12px; gap: 4px; }
  .btn-link:hover { background: #1a45b0; }

  /* íƒ­ */
  .tabs { display: flex; gap: 0; border-bottom: 2px solid var(--border); margin-bottom: 24px; }
  .tab { padding: 10px 20px; font-size: 14px; font-weight: 500; color: var(--gray); cursor: pointer; border-bottom: 2px solid transparent; margin-bottom: -2px; }
  .tab.active { color: var(--blue); border-bottom-color: var(--blue); font-weight: 600; }

  /* ë¡œë”© */
  .loading { text-align: center; padding: 60px; color: var(--gray); font-size: 14px; }
  .spinner { width: 32px; height: 32px; border: 3px solid var(--border); border-top-color: var(--blue); border-radius: 50%; animation: spin 0.8s linear infinite; margin: 0 auto 12px; }
  @keyframes spin { to { transform: rotate(360deg); } }

  @media (max-width: 640px) {
    .summary-grid { grid-template-columns: 1fr 1fr; }
    .guide-grid { grid-template-columns: 1fr; }
    .condition-list { flex-direction: column; gap: 8px; }
  }
</style>
</head>
<body>

<nav class="navbar">
  <a href="dashboard.html" class="navbar-brand">StaffManager</a>
  <a href="dashboard.html" class="navbar-back">â† ëŒ€ì‹œë³´ë“œ</a>
</nav>

<div class="container">
  <h1>ğŸ›ï¸ ì •ë¶€ì§€ì›ê¸ˆ ìë™ê³„ì‚°ê¸°</h1>
  <p class="subtitle">ë‘ë£¨ëˆ„ë¦¬ ì‚¬íšŒë³´í—˜ë£Œ ì§€ì› ëŒ€ìƒ ì—¬ë¶€ë¥¼ ìë™ìœ¼ë¡œ í™•ì¸í•˜ê³  ì ˆê° ê°€ëŠ¥ ê¸ˆì•¡ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>

  <!-- ì¡°ê±´ ì•ˆë‚´ -->
  <div class="condition-box">
    <h3>ğŸ“‹ 2026ë…„ ë‘ë£¨ëˆ„ë¦¬ ì§€ì› ìš”ê±´</h3>
    <div class="condition-list">
      <span class="condition-item">10ì¸ ë¯¸ë§Œ ì‚¬ì—…ì¥</span>
      <span class="condition-item">ì›”í‰ê· ë³´ìˆ˜ 270ë§Œì› ë¯¸ë§Œ ê·¼ë¡œì</span>
      <span class="condition-item">êµ­ë¯¼ì—°ê¸ˆ + ê³ ìš©ë³´í—˜ ê° 80% ì§€ì›</span>
      <span class="condition-item">ìµœëŒ€ 36ê°œì›” (ì‹ ê·œê°€ì…ì)</span>
      <span class="condition-item">ì‚¬ì—…ì£¼ Â· ê·¼ë¡œì ê°ê° ì§€ì›</span>
    </div>
  </div>

  <!-- ì¸ì› ì´ˆê³¼ ê²½ê³  -->
  <div class="warning-box" id="warningBox">
    âš ï¸ <span id="warningText"></span>
  </div>

  <!-- ìš”ì•½ ì¹´ë“œ -->
  <div class="summary-grid">
    <div class="summary-card green">
      <div class="label">ì›” ì ˆê° ê°€ëŠ¥ì•¡ (ì‚¬ì—…ì£¼)</div>
      <div class="value" id="sumEmployer">â€”</div>
    </div>
    <div class="summary-card green">
      <div class="label">ì›” ì ˆê° ê°€ëŠ¥ì•¡ (ê·¼ë¡œì)</div>
      <div class="value" id="sumEmployee">â€”</div>
    </div>
    <div class="summary-card blue">
      <div class="label">ì—°ê°„ ì ˆê° í•©ê³„</div>
      <div class="value" id="sumAnnual">â€”</div>
    </div>
    <div class="summary-card orange">
      <div class="label">ì§€ì› ëŒ€ìƒ / ì „ì²´ ì§ì›</div>
      <div class="value" id="sumRatio">â€”</div>
    </div>
  </div>

  <!-- íƒ­ -->
  <div class="tabs">
    <div class="tab active" onclick="showTab('eligible')">âœ… ì§€ì› ëŒ€ìƒ</div>
    <div class="tab" onclick="showTab('ineligible')">âŒ ëŒ€ìƒ ì•„ë‹˜</div>
    <div class="tab" onclick="showTab('guide')">ğŸ“– ì‹ ì²­ ì•ˆë‚´</div>
  </div>

  <!-- ì§€ì› ëŒ€ìƒ í…Œì´ë¸” -->
  <div id="tabEligible">
    <div class="table-wrap">
      <div class="table-header">
        <h2>ë‘ë£¨ëˆ„ë¦¬ ì§€ì› ëŒ€ìƒ ì§ì›</h2>
        <span class="badge badge-green" id="eligibleCount">0ëª…</span>
      </div>
      <div id="eligibleBody">
        <div class="loading"><div class="spinner"></div>ì§ì› ì •ë³´ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
      </div>
    </div>
  </div>

  <!-- ë¯¸ëŒ€ìƒ í…Œì´ë¸” -->
  <div id="tabIneligible" style="display:none">
    <div class="table-wrap">
      <div class="table-header">
        <h2>ì§€ì› ëŒ€ìƒ ì œì™¸ ì§ì›</h2>
        <span class="badge badge-red" id="ineligibleCount">0ëª…</span>
      </div>
      <div id="ineligibleBody">
        <div class="loading"><div class="spinner"></div>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
      </div>
    </div>
  </div>

  <!-- ì‹ ì²­ ì•ˆë‚´ -->
  <div id="tabGuide" style="display:none">
    <div class="guide-grid">
      <div class="guide-card">
        <h3>ğŸ–¥ï¸ ì˜¨ë¼ì¸ ì‹ ì²­</h3>
        <p>4ëŒ€ì‚¬íšŒë³´í—˜ ì •ë³´ì—°ê³„ì„¼í„°ì—ì„œ ê°„í¸ ì‹ ì²­ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
        <ul style="margin-top:8px">
          <li>ì‚¬ì—…ì¥ íšŒì› ë¡œê·¸ì¸</li>
          <li>ìƒë‹¨ 'ì‚¬ì—…ì¥ì—…ë¬´' â†’ 'ë‘ë£¨ëˆ„ë¦¬ë³´í—˜ë£Œì§€ì›' í´ë¦­</li>
          <li>ì§€ì› ëŒ€ìƒ ê·¼ë¡œì ì„ íƒ í›„ ì‹ ì²­</li>
        </ul>
        <a href="https://www.4insure.or.kr" target="_blank" class="btn-link">4ëŒ€ë³´í—˜ ì •ë³´ì—°ê³„ì„¼í„° â†’</a>
      </div>
      <div class="guide-card">
        <h3>ğŸ“‹ ì§€ì› ë°©ì‹</h3>
        <ul>
          <li>í˜„ê¸ˆ ì§€ê¸‰ âŒ â†’ <strong>ë‹¤ìŒ ë‹¬ ë³´í—˜ë£Œì—ì„œ ì°¨ê°</strong></li>
          <li>ë‹¹ì›” ë³´í—˜ë£Œ ë²•ì •ê¸°í•œ ë‚´ ë‚©ë¶€ í•„ìˆ˜</li>
          <li>ê·¼ë¡œì ìˆ˜ ë³€ë™ ì‹œ ì¦‰ì‹œ ì‹ ê³  í•„ìš”</li>
          <li>ì¬ì‚°Â·ì†Œë“ ê¸°ì¤€ ì´ˆê³¼ ì‹œ ì œì™¸</li>
        </ul>
      </div>
      <div class="guide-card">
        <h3>ğŸ“ ë¬¸ì˜ì²˜</h3>
        <ul>
          <li>ê·¼ë¡œë³µì§€ê³µë‹¨: <strong>1588-0075</strong></li>
          <li>êµ­ë¯¼ì—°ê¸ˆê³µë‹¨: <strong>1355</strong></li>
          <li>ê³ ìš©ë³´í—˜: <strong>1350</strong></li>
        </ul>
      </div>
      <div class="guide-card">
        <h3>âš ï¸ ì£¼ì˜ì‚¬í•­</h3>
        <ul>
          <li>2021ë…„ë¶€í„° <strong>ì‹ ê·œ ê°€ì…ìë§Œ</strong> ì§€ì›</li>
          <li>ë³´ìˆ˜ 270ë§Œì› ì´ìƒ ì‹œ ì¦‰ì‹œ ì§€ì› ì¤‘ë‹¨</li>
          <li>10ì¸ ì´ìƒì´ ë˜ë©´ ì§€ì› ì¤‘ë‹¨</li>
          <li>ì¼ìë¦¬ ì•ˆì •ìê¸ˆ ë“±ê³¼ ì¤‘ë³µ ë¶ˆê°€</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<script>
// â”€â”€ ìƒìˆ˜ (2026ë…„ ê¸°ì¤€) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const LIMIT_SALARY = 2700000;       // 270ë§Œì› ë¯¸ë§Œ
const LIMIT_HEADCOUNT = 10;         // 10ì¸ ë¯¸ë§Œ
const SUPPORT_RATE = 0.80;          // 80% ì§€ì›

// ë³´í—˜ë£Œìœ¨
const NP_EMP  = 0.045;  // êµ­ë¯¼ì—°ê¸ˆ ê·¼ë¡œì
const NP_ER   = 0.045;  // êµ­ë¯¼ì—°ê¸ˆ ì‚¬ì—…ì£¼
const EI_EMP  = 0.009;  // ê³ ìš©ë³´í—˜ ê·¼ë¡œì
const EI_ER   = 0.0115; // ê³ ìš©ë³´í—˜ ì‚¬ì—…ì£¼ (150ì¸ ë¯¸ë§Œ)

// â”€â”€ ë‘ë£¨ëˆ„ë¦¬ ê³„ì‚° í•¨ìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calcDurunuri(monthlySalary) {
  if (monthlySalary <= 0) return null;
  const np_emp  = Math.round(monthlySalary * NP_EMP  * SUPPORT_RATE);
  const np_er   = Math.round(monthlySalary * NP_ER   * SUPPORT_RATE);
  const ei_emp  = Math.round(monthlySalary * EI_EMP  * SUPPORT_RATE);
  const ei_er   = Math.round(monthlySalary * EI_ER   * SUPPORT_RATE);
  return {
    employee: np_emp + ei_emp,          // ê·¼ë¡œì ì§€ì›ì•¡/ì›”
    employer: np_er  + ei_er,           // ì‚¬ì—…ì£¼ ì§€ì›ì•¡/ì›”
    np_emp, np_er, ei_emp, ei_er,
    total: np_emp + ei_emp + np_er + ei_er
  };
}

function fmt(n) { return Math.round(n).toLocaleString('ko-KR') + 'ì›'; }

// â”€â”€ íƒ­ ì „í™˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showTab(name) {
  ['eligible','ineligible','guide'].forEach(t => {
    document.getElementById('tab' + t.charAt(0).toUpperCase() + t.slice(1)).style.display = 'none';
  });
  document.querySelectorAll('.tab').forEach((el, i) => {
    el.classList.toggle('active', ['eligible','ineligible','guide'][i] === name);
  });
  document.getElementById('tab' + name.charAt(0).toUpperCase() + name.slice(1)).style.display = 'block';
}

// â”€â”€ ë©”ì¸ ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadData() {
  const token = sessionStorage.getItem('authToken');
  if (!token) { location.href = 'login.html'; return; }

  // ì§ì› ëª©ë¡ ì¡°íšŒ
  let employees = [];
  try {
    const res = await fetch('/.netlify/functions/employees-list', {
      headers: { 'Authorization': 'Bearer ' + token }
    });
    const json = await res.json();
    employees = json.data || json.employees || json || [];
    if (!Array.isArray(employees)) employees = [];
  } catch(e) {
    document.getElementById('eligibleBody').innerHTML =
      '<div class="loading" style="color:#DC2626">ì§ì› ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨. ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.</div>';
    return;
  }

  const activeEmp = employees.filter(e => e.status !== 'inactive');
  const headcount = activeEmp.length;

  // ì¸ì› ì´ˆê³¼ ê²½ê³ 
  if (headcount >= LIMIT_HEADCOUNT) {
    document.getElementById('warningBox').classList.add('show');
    document.getElementById('warningText').textContent =
      `í˜„ì¬ ì‚¬ì—…ì¥ ì¬ì§ ì¸ì›ì´ ${headcount}ëª…ì…ë‹ˆë‹¤. ë‘ë£¨ëˆ„ë¦¬ ì§€ì›ì€ 10ì¸ ë¯¸ë§Œ ì‚¬ì—…ì¥ì—ë§Œ í•´ë‹¹ë©ë‹ˆë‹¤. ì¼ë¶€ ì§ì›ì˜ ì§€ì›ì´ ì¤‘ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;
  }

  const eligible = [], ineligible = [];

  activeEmp.forEach(emp => {
    // ì›”ë³´ìˆ˜ = ê¸°ë³¸ê¸‰ ê¸°ì¤€ (ê³„ì‚°ëœ ê¸‰ì—¬ê°€ ìˆìœ¼ë©´ ê·¸ê±¸ ìš°ì„ )
    const salary = Number(emp.base_salary || emp.hourly_wage * 209 || 0);
    const reason = [];

    if (salary <= 0)           reason.push('ê¸‰ì—¬ ì •ë³´ ì—†ìŒ');
    if (salary >= LIMIT_SALARY) reason.push(`ì›”ë³´ìˆ˜ ${fmt(salary)} â‰¥ 270ë§Œì›`);

    if (reason.length === 0) {
      eligible.push({ ...emp, salary, subsidy: calcDurunuri(salary) });
    } else {
      ineligible.push({ ...emp, salary, reason: reason.join(', ') });
    }
  });

  // ì§‘ê³„
  const totalEmployer = eligible.reduce((s, e) => s + e.subsidy.employer, 0);
  const totalEmployee = eligible.reduce((s, e) => s + e.subsidy.employee, 0);
  const totalAnnual   = (totalEmployer + totalEmployee) * 12;

  document.getElementById('sumEmployer').textContent  = fmt(totalEmployer) + '/ì›”';
  document.getElementById('sumEmployee').textContent  = fmt(totalEmployee) + '/ì›”';
  document.getElementById('sumAnnual').textContent    = fmt(totalAnnual) + '/ë…„';
  document.getElementById('sumRatio').textContent     = `${eligible.length} / ${activeEmp.length}ëª…`;
  document.getElementById('eligibleCount').textContent = eligible.length + 'ëª…';
  document.getElementById('ineligibleCount').textContent = ineligible.length + 'ëª…';

  // â”€â”€ ì§€ì› ëŒ€ìƒ í…Œì´ë¸” ë Œë” â”€â”€
  if (eligible.length === 0) {
    document.getElementById('eligibleBody').innerHTML =
      '<div class="loading" style="color:var(--gray)">ì§€ì› ëŒ€ìƒ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
  } else {
    document.getElementById('eligibleBody').innerHTML = `
      <table>
        <thead>
          <tr>
            <th>ì§ì›ëª…</th>
            <th>ë¶€ì„œ</th>
            <th>ì›”ë³´ìˆ˜</th>
            <th>ê·¼ë¡œì ì§€ì›ì•¡/ì›”</th>
            <th>ì‚¬ì—…ì£¼ ì§€ì›ì•¡/ì›”</th>
            <th>í•©ê³„/ì›”</th>
            <th>ì—°ê°„ ì ˆê°ì•¡</th>
            <th>ìƒíƒœ</th>
          </tr>
        </thead>
        <tbody>
          ${eligible.map(e => `
            <tr>
              <td><strong>${e.name}</strong></td>
              <td>${e.department || '-'}</td>
              <td class="amount">${fmt(e.salary)}</td>
              <td>
                <span class="amount green">${fmt(e.subsidy.employee)}</span>
                <div class="detail-cell">ì—°ê¸ˆ ${fmt(e.subsidy.np_emp)} + ê³ ìš© ${fmt(e.subsidy.ei_emp)}</div>
              </td>
              <td>
                <span class="amount green">${fmt(e.subsidy.employer)}</span>
                <div class="detail-cell">ì—°ê¸ˆ ${fmt(e.subsidy.np_er)} + ê³ ìš© ${fmt(e.subsidy.ei_er)}</div>
              </td>
              <td class="amount green">${fmt(e.subsidy.total)}</td>
              <td class="amount green">${fmt(e.subsidy.total * 12)}</td>
              <td><span class="badge badge-green">ëŒ€ìƒ</span></td>
            </tr>
          `).join('')}
        </tbody>
      </table>`;
  }

  // â”€â”€ ë¯¸ëŒ€ìƒ í…Œì´ë¸” ë Œë” â”€â”€
  if (ineligible.length === 0) {
    document.getElementById('ineligibleBody').innerHTML =
      '<div class="loading" style="color:var(--gray)">ëª¨ë“  ì§ì›ì´ ì§€ì› ëŒ€ìƒì…ë‹ˆë‹¤. ğŸ‰</div>';
  } else {
    document.getElementById('ineligibleBody').innerHTML = `
      <table>
        <thead>
          <tr>
            <th>ì§ì›ëª…</th>
            <th>ë¶€ì„œ</th>
            <th>ì›”ë³´ìˆ˜</th>
            <th>ì œì™¸ ì‚¬ìœ </th>
          </tr>
        </thead>
        <tbody>
          ${ineligible.map(e => `
            <tr>
              <td><strong>${e.name}</strong></td>
              <td>${e.department || '-'}</td>
              <td class="amount ${e.salary >= LIMIT_SALARY ? 'gray' : ''}">${e.salary > 0 ? fmt(e.salary) : '-'}</td>
              <td><span class="badge badge-red">${e.reason}</span></td>
            </tr>
          `).join('')}
        </tbody>
      </table>`;
  }
}

loadData();
</script>
</body>
</html>
